<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GHOST SCRIPTS // COLLECTIVE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cyber-red': '#ff0000',
                        'cyber-dark': '#000000',
                        'cyber-panel': 'rgba(20, 0, 0, 0.95)',
                        'cyber-grid': 'rgba(255, 0, 0, 0.1)',
                    },
                    fontFamily: {
                        'hud': ['"Share Tech Mono"', 'monospace'],
                        'body': ['"Rajdhani"', 'sans-serif'],
                    },
                    animation: {
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'scan': 'scan 4s linear infinite',
                    },
                    keyframes: {
                        scan: {
                            '0%': { transform: 'translateY(-100%)' },
                            '100%': { transform: 'translateY(100%)' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #000000;
            color: #e0e0e0;
            overflow-x: hidden;
            background-image: 
                linear-gradient(rgba(255, 0, 0, 0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 0, 0, 0.05) 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: center top;
        }

        /* Cyberpunk HUD Shapes */
        .hud-panel {
            clip-path: polygon(
                20px 0, 100% 0, 
                100% calc(100% - 20px), calc(100% - 20px) 100%, 
                0 100%, 0 20px
            );
            border-left: 2px solid rgba(255, 0, 0, 0.5);
            position: relative;
        }

        .hud-panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0;
            width: 20px; height: 2px;
            background: #ff0000;
        }
        
        .hud-panel::after {
            content: '';
            position: absolute;
            bottom: 0; right: 0;
            width: 20px; height: 2px;
            background: #ff0000;
        }

        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: #ff0000; border-radius: 3px; }

        #bg-canvas { position: fixed; top: 0; left: 0; z-index: -1; pointer-events: none; }

        .nav-btn.active {
            background: linear-gradient(90deg, rgba(255, 0, 0, 0.3), transparent);
            border-left: 4px solid #ff0000;
            color: #fff;
            padding-left: 1.5rem;
        }

        .typing-cursor::after {
            content: '_';
            animation: blink 1s step-end infinite;
            color: #ff0000;
        }

        @keyframes blink { 50% { opacity: 0; } }

        #transition-overlay { background: rgba(0, 0, 0, 0.9); backdrop-filter: blur(4px); }
        .glitch-text-transition { text-shadow: 2px 0 #fff, -2px 0 #ff0000; }
    </style>
</head>
<body class="font-body min-h-screen flex flex-col text-gray-300">

    <canvas id="bg-canvas"></canvas>

    <div id="mobile-overlay" onclick="toggleMenu()" class="fixed inset-0 z-40 hidden md:hidden transition-opacity opacity-0"></div>

    <header class="w-full h-16 border-b border-red-900/30 bg-black/90 backdrop-blur-sm flex justify-between items-center px-4 md:px-6 sticky top-0 z-50">
        <div class="flex items-center gap-3 z-50">
            <div class="w-8 h-8 bg-cyber-red transform rotate-45 flex items-center justify-center border border-black">
                <div class="transform -rotate-45 font-bold text-black font-hud">GS</div>
            </div>
            <div>
                <h1 class="font-hud text-xl md:text-2xl tracking-widest text-white">GHOST<span class="text-cyber-red">_</span>SCRIPTS</h1>
                <div class="text-[8px] md:text-[10px] tracking-[0.2em] md:tracking-[0.3em] text-cyber-red uppercase font-bold">Cybersecurity Enthusiast Collective</div>
            </div>
        </div>
        
        <div class="hidden md:flex gap-8 font-hud text-sm tracking-wider">
            <div class="flex flex-col items-end">
                <span class="text-xs text-gray-500">SYS.TIME</span>
                <span id="clock" class="text-cyber-red">00:00:00</span>
            </div>
            <div class="flex flex-col items-end">
                <span class="text-xs text-gray-500">NET.STATUS</span>
                <span id="db-status" class="text-cyber-red animate-pulse">CONNECTING...</span>
            </div>
        </div>

        <button id="menu-btn" onclick="toggleMenu()" class="md:hidden text-cyber-red text-2xl focus:outline-none hover:text-white transition-colors z-50">
            <i class="fas fa-bars"></i>
        </button>
    </header>

    <div class="container mx-auto p-4 md:p-8 flex-grow flex flex-col md:flex-row gap-8 mt-4">
        
        <aside id="sidebar" class="fixed inset-y-0 left-0 z-[60] w-72 md:w-64 bg-black md:bg-transparent border-r border-cyber-red/50 md:border-red-900/30 md:border-none p-6 md:p-0 transform -translate-x-full md:translate-x-0 transition-transform duration-300 md:static md:inset-auto md:flex flex-col gap-6 shadow-2xl md:shadow-none h-full overflow-y-auto md:overflow-visible">
            
            <div class="flex justify-between items-center mb-8 md:hidden border-b border-red-900/30 pb-4">
                <span class="font-hud text-cyber-red text-lg font-bold">SYSTEM_MENU</span>
                <button onclick="toggleMenu()" class="text-white hover:text-cyber-red px-2">
                    <i class="fas fa-times text-2xl"></i>
                </button>
            </div>

            <div class="hud-panel bg-cyber-panel p-6 backdrop-blur-md">
                <div class="flex justify-between items-end border-b border-red-900/30 pb-2 mb-4">
                    <span class="font-hud text-cyber-red">TEAM ID</span>
                    <span id="team-id-display" class="font-hud text-2xl font-bold text-white animate-pulse">...</span>
                </div>
                <div class="space-y-3 font-hud text-xs">
                    <div class="flex justify-between">
                        <span>NAME</span>
                        <span id="team-name-display" class="text-cyber-red">LOADING</span>
                    </div>
                    <div class="flex justify-between">
                        <span>REGION</span>
                        <span id="team-region-display">LOADING</span> 
                    </div>
                    <div class="flex justify-between">
                        <span>STATUS</span>
                        <span id="team-status-display" class="text-green-500">ONLINE</span>
                    </div>
                </div>
            </div>

            <nav class="flex flex-col gap-2 font-hud tracking-wide mt-4 md:mt-0">
                <button onclick="navTo('manifesto')" id="btn-manifesto" class="nav-btn active text-left px-4 py-4 md:py-3 text-white transition-all duration-300 hover:text-cyber-red hover:bg-white/10 border-l-4 border-transparent bg-white/5 md:bg-transparent">
                    // MANIFESTO
                </button>
                <button onclick="navTo('roster')" id="btn-roster" class="nav-btn text-left px-4 py-4 md:py-3 text-white transition-all duration-300 hover:text-cyber-red hover:bg-white/10 border-l-4 border-transparent bg-white/5 md:bg-transparent">
                    // ROSTER
                </button>
                <button onclick="navTo('trophy')" id="btn-trophy" class="nav-btn text-left px-4 py-4 md:py-3 text-white transition-all duration-300 hover:text-cyber-red hover:bg-white/10 border-l-4 border-transparent bg-white/5 md:bg-transparent">
                    // TROPHY_ROOM
                </button>
                <button onclick="navTo('writeups')" id="btn-writeups" class="nav-btn text-left px-4 py-4 md:py-3 text-white transition-all duration-300 hover:text-cyber-red hover:bg-white/10 border-l-4 border-transparent bg-white/5 md:bg-transparent">
                    // WRITEUPS_LOG
                </button>
                <button onclick="navTo('contact')" id="btn-contact" class="nav-btn text-left px-4 py-4 md:py-3 text-white transition-all duration-300 hover:text-cyber-red hover:bg-white/10 border-l-4 border-transparent bg-white/5 md:bg-transparent">
                    // CONTACT
                </button>
            </nav>

            <div class="mt-auto md:hidden pt-8 text-xs font-hud text-center opacity-70 text-white">
                <div class="mb-2">SYS.TIME: <span id="mobile-clock">00:00:00</span></div>
                <div class="text-cyber-red">CONNECTED via MOBILE_UPLINK</div>
            </div>
        </aside>

        <main class="flex-grow relative z-10 w-full">
            <div class="absolute -top-1 -left-1 w-8 h-8 border-t-2 border-l-2 border-cyber-red"></div>
            <div class="absolute -top-1 -right-1 w-8 h-8 border-t-2 border-r-2 border-cyber-red"></div>
            <div class="absolute -bottom-1 -left-1 w-8 h-8 border-b-2 border-l-2 border-cyber-red"></div>
            <div class="absolute -bottom-1 -right-1 w-8 h-8 border-b-2 border-r-2 border-cyber-red"></div>

            <div class="bg-cyber-panel h-full w-full backdrop-blur-md border border-red-900/30 p-4 sm:p-8 md:p-12 shadow-2xl relative overflow-hidden min-h-[80vh]">
                
                <div id="transition-overlay" class="absolute inset-0 z-50 flex items-center justify-center hidden">
                    <div class="text-center">
                        <div id="transition-text" class="text-3xl md:text-5xl font-hud text-cyber-red glitch-text-transition tracking-widest font-bold">LOADING...</div>
                        <div class="mt-2 h-1 w-full bg-red-900/50 overflow-hidden">
                            <div class="h-full bg-cyber-red animate-pulse w-1/2 mx-auto"></div>
                        </div>
                    </div>
                </div>

                <div class="absolute top-0 left-0 w-full h-1 bg-cyber-red/30 animate-scan z-0 pointer-events-none"></div>

                <section id="manifesto" class="content-section relative z-10">
                    <h2 class="font-hud text-3xl md:text-5xl mb-2 text-white"><span class="text-cyber-red">01.</span> MANIFESTO</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyber-red to-transparent mb-8"></div>
                    <div class="font-body text-base md:text-xl space-y-6 max-w-3xl leading-relaxed">
                        <p id="typewriter-text" class="typing-cursor text-cyber-red font-mono min-h-[100px]"></p>
                        <div class="p-6 border-l-2 border-cyber-red bg-black/50 mt-8">
                            <h3 class="font-hud text-xl text-cyber-red mb-2">CORE DIRECTIVE</h3>
                            <p class="opacity-80">We play CTFs for the thrill of the puzzle. We dismantle systems to understand their soul. United by curiosity, coffee, and the drive to learn what makes the digital world tick.</p>
                        </div>
                    </div>
                </section>

                <section id="roster" class="content-section hidden relative z-10">
                    <h2 class="font-hud text-3xl md:text-4xl mb-2 text-white"><span class="text-cyber-red">02.</span> ACTIVE_UNITS</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyber-red to-transparent mb-8"></div>
                    <div id="roster-container" class="grid grid-cols-1 xl:grid-cols-2 gap-6">
                         <div class="text-cyber-red font-hud animate-pulse">DECRYPTING_PERSONNEL_FILES...</div>
                    </div>
                </section>

                <section id="trophy" class="content-section hidden relative z-10">
                    <h2 class="font-hud text-3xl md:text-4xl mb-2 text-white"><span class="text-cyber-red">03.</span> ACHIEVEMENTS</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyber-red to-transparent mb-8"></div>
                    <div id="trophy-list" class="space-y-4">
                        <div class="text-cyber-red font-hud animate-pulse">ESTABLISHING_DB_UPLINK...</div>
                    </div>
                </section>

                <section id="writeups" class="content-section hidden relative z-10">
                    <h2 class="font-hud text-3xl md:text-4xl mb-2 text-white"><span class="text-cyber-red">04.</span> LOGS</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyber-red to-transparent mb-8"></div>
                    <div id="writeups-container" class="grid gap-6">
                         <div class="text-cyber-red font-hud animate-pulse">SCANNING_NETWORKS...</div>
                    </div>
                </section>

                <section id="contact" class="content-section hidden relative z-10">
                    <h2 class="font-hud text-3xl md:text-4xl mb-2 text-white"><span class="text-cyber-red">05.</span> CONTACT</h2>
                    <div class="h-1 w-24 bg-gradient-to-r from-cyber-red to-transparent mb-8"></div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        <div>
                            <p class="mb-6 opacity-80">Secure communications enabled. Use the form below to establish a handshake.</p>
                            
                            <div class="mb-6 flex items-center gap-4 p-4 border border-white/10 bg-white/5">
                                <i class="fas fa-envelope text-cyber-red text-2xl"></i>
                                <div>
                                    <div class="text-xs text-gray-500 font-hud">SECURE_MAIL</div>
                                    <div class="text-lg font-mono text-white selection:bg-cyber-red selection:text-black">ghostscripts@proton.me</div>
                                </div>
                            </div>
                            
                            <form action="https://formcarry.com/s/YeP--L2cuIB" method="POST" class="space-y-4">
                                <div>
                                    <label class="block font-hud text-xs text-cyber-red mb-1">HANDLE / NAME</label>
                                    <input type="text" name="name" required class="w-full bg-black/50 border border-red-900/30 p-2 focus:border-cyber-red focus:outline-none text-white font-mono" placeholder="Callsign or Name">
                                </div>
                                <div>
                                    <label class="block font-hud text-xs text-cyber-red mb-1">CONTACT_REF</label>
                                    <input type="text" name="contact_info" required class="w-full bg-black/50 border border-red-900/30 p-2 focus:border-cyber-red focus:outline-none text-white font-mono" placeholder="Email or Discord Handle">
                                </div>
                                <div>
                                    <label class="block font-hud text-xs text-cyber-red mb-1">TOPIC</label>
                                    <select name="topic" class="w-full bg-black/50 border border-red-900/30 p-2 focus:border-cyber-red focus:outline-none text-white font-mono">
                                        <option value="Join">Join the Team</option>
                                        <option value="Collab">Collaboration / Study Group</option>
                                        <option value="Hello">Just saying hi</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block font-hud text-xs text-cyber-red mb-1">MESSAGE</label>
                                    <textarea name="message" rows="5" class="w-full bg-black/50 border border-red-900/30 p-2 focus:border-cyber-red focus:outline-none text-white font-mono" placeholder="Encrypted payload..."></textarea>
                                </div>
                                <button type="submit" class="w-full bg-cyber-red/20 border border-cyber-red text-cyber-red font-hud py-2 hover:bg-cyber-red hover:text-black transition-all uppercase tracking-widest">
                                    TRANSMIT DATA
                                </button>
                            </form>
                        </div>
                        
                        <div class="flex flex-col justify-center items-center p-8 border border-red-900/30 bg-black/50 h-full">
                            <div class="w-48 h-48 bg-white p-2 mb-4">
                                <img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=2b5sPO0wV5ZcmP43roNDZVU7Zrdfg9W0on7Le75irDrqLDFPCZjxt4V4rcP3QIXHG5lAm8urRKCXUo5gjQbrqvWvs22gSFGI8z3Mx3BvBCynNoealfNMfpnrEIma1rczKVadDXdv6HwAW175qRsMqaOMctOIzdkTbc7fnVXhnCnXu5pCWZw24FcKm0qcrEtNmH2T4nreT8qhp81r0Wq0fwFZU1QSM2dNaGu6JVeJuhYIbOW2zLVyBdwm4oDrKeXtTRn3UUQoxVV1O7zDvs5Bwf9fhnzbMT0lydwzxfpjH8W9qFEpdLsDqOCkZrxRgnT9P7bGtWthYawDlNOVh00MEVlyc6vxPRLecHg4GkR6azZwZcVMk6exbSVlERbXB8IhP6FRkuwimrfGcd9JYuHOMb8nBzA8R1bwOXAJE6cr3Xy9GHuZLKPyzEtFtm1IJi38ILTigLcd71q3JZ2fm9YGPuHB8SnI" class="w-full h-full" alt="Community QR">
                            </div>
                            <div class="font-mono text-xs text-center break-all opacity-60 mb-6">
                                SCAN TO TUNE IN WITH THE MEMBERS FREQUENCY<br>
                            </div>
                            <div class="flex gap-6 mt-2">
                                <a href="https://github.com/ghostscripts-collective" target="_blank" class="text-3xl text-white hover:text-cyber-red transition-transform hover:scale-110">
                                    <i class="fab fa-github"></i>
                                </a>
                                <a href="https://discord.gg/jWZF5hmE" target="_blank" class="text-3xl text-white hover:text-cyber-red transition-transform hover:scale-110">
                                    <i class="fab fa-discord"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <script>
        // --- CONFIGURATION ---
        const TEAM_ID = 415956; // Your CTFTime Team ID
        
        // Supabase Config
        const SUPABASE_URL = 'https://laoqgmeaxbikeitfzgkh.supabase.co';
        const SUPABASE_ANON_KEY = 'sb_publishable_w0dkhf3MvSHcwET_YJNb8g_-drftIMk'; 
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        
        const statusIndicator = document.getElementById('db-status');
        function setOnline() {
            statusIndicator.innerText = "ONLINE";
            statusIndicator.classList.remove('animate-pulse');
            statusIndicator.classList.add('text-green-500');
        }

        // --- 1. SIDEBAR: Fetch Name/Region from CTFTime API ---
        async function initCTFTimeStats() {
            const nameEl = document.getElementById('team-name-display');
            const regionEl = document.getElementById('team-region-display');
            const idEl = document.getElementById('team-id-display');
            
            const targetUrl = `https://ctftime.org/api/v1/teams/${TEAM_ID}/`;
            const proxyUrl = `https://api.allorigins.win/get?url=${encodeURIComponent(targetUrl)}`;

            try {
                const response = await fetch(proxyUrl);
                if (!response.ok) throw new Error('Proxy network response was not ok');
                const data = await response.json();
                const teamData = JSON.parse(data.contents);
                
                if (teamData) {
                    nameEl.innerText = teamData.name ? teamData.name.toUpperCase() : 'GHOST_SCRIPTS';
                    regionEl.innerText = teamData.country ? teamData.country.toUpperCase() : 'GLOBAL';
                    idEl.innerText = `#${teamData.id}`;
                    setOnline(); 
                }
            } catch (e) {
                console.error('CTFTime Profile Error:', e);
                nameEl.innerText = 'GHOST_SCRIPTS';
                regionEl.innerText = 'GLOBAL'; 
            }
        }

        // --- 2. TROPHY ROOM: SUPABASE (Back to Database) ---
        async function initTrophyRoom() {
            const container = document.getElementById('trophy-list');
            if(!container) return;
            try {
                const { data: events, error } = await supabase
                    .from('trophies')
                    .select('*')
                    .order('created_at', { ascending: false }); // Sort by newest entry

                if (error) throw error;
                if (events && events.length > 0) {
                    setOnline();
                    container.innerHTML = '';
                    events.forEach(event => {
                        const rankVal = parseInt(event.rank_place);
                        const isTop = rankVal <= 100;
                        const category = isTop ? 'TOP' : 'FUN';
                        const categoryColor = isTop ? 'text-cyber-red opacity-80' : 'text-white opacity-60';
                        const subLabel = isTop ? 'COMPETITIVE' : 'PARTICIPATION';
                        container.innerHTML += `
                        <div class="flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6 p-4 border-b border-red-900/30 hover:bg-white/5 transition-colors">
                            <div class="text-4xl font-hud font-bold ${categoryColor}">${category}</div>
                            <div class="flex-grow">
                                <h3 class="font-bold text-lg md:text-xl">${event.event_name}</h3>
                                <p class="text-sm opacity-60">Rank: #${event.rank_place} // Year: ${event.event_year}</p>
                            </div>
                            <div class="text-left sm:text-right w-full sm:w-auto flex justify-between sm:block">
                                <div class="font-hud text-cyber-red">${event.points || 'N/A'} PTS</div>
                                <div class="text-xs opacity-50">${subLabel}</div>
                            </div>
                        </div>`;
                    });
                } else { container.innerHTML = '<div class="text-gray-500 font-hud p-4">DATABASE_EMPTY</div>'; }
            } catch (err) { console.error('Trophy Error:', err); container.innerHTML = '<div class="text-red-500 font-hud">CONNECTION_FAILED</div>'; }
        }

        // --- 3. ROSTER: Supabase ---
        async function initRoster() {
            const container = document.getElementById('roster-container');
            if(!container) return;
            try {
                const { data: members, error } = await supabase
                    .from('roster')
                    .select('*')
                    .order('is_captain', { ascending: false });
                if (error) throw error;
                container.innerHTML = '';
                if (members && members.length > 0) {
                    members.forEach(member => {
                        const skills = member.skills || [];
                        let tagsHtml = '';
                        skills.forEach(skill => {
                            const isRed = skill === 'C/C++' || skill === 'PYTHON' || skill === 'GO' || skill === 'RUST';
                            const borderColor = isRed ? 'border-cyber-red/30' : 'border-white/30';
                            const bg = isRed ? 'bg-cyber-red/10' : 'bg-white/10';
                            const textColor = isRed ? 'text-cyber-red' : 'text-white';
                            tagsHtml += `<span class="px-2 py-1 ${bg} border ${borderColor} text-[10px] ${textColor}">${skill}</span>`;
                        });
                        container.innerHTML += `
                        <div class="hud-panel bg-black/60 p-6 group hover:bg-white/5 transition-all">
                            <div class="flex justify-between items-start mb-4">
                                <div>
                                    <h3 class="font-hud text-xl md:text-2xl text-white group-hover:text-cyber-red transition-colors">${member.name}</h3>
                                    <span class="text-xs text-cyber-red tracking-widest font-bold">${member.role}</span>
                                </div>
                                <div class="w-10 h-10 border border-white/20 flex items-center justify-center">
                                    <i class="${member.icon_class} text-xl"></i>
                                </div>
                            </div>
                            <p class="text-sm opacity-70 mb-4 font-mono">${member.bio || ''}</p>
                            <div class="flex flex-wrap gap-2">${tagsHtml}</div>
                        </div>`;
                    });
                } else { container.innerHTML = '<div class="text-gray-500 font-hud">NO_AGENTS_FOUND</div>'; }
            } catch (err) { console.error('Roster Error:', err); container.innerHTML = '<div class="text-red-500 font-hud">ENCRYPTED_CONNECTION_FAILED</div>'; }
        }

        // --- RSS Writeups ---
        let allWriteupPosts = [];
        let currentWriteupPage = 1;
        const WRITEUPS_PER_PAGE = 5;

        async function initWriteups() {
            const members = ['cromwell', 'seraphiem', 'klienzxa','smoking_nilaga','paradox','wisadel'];
            const container = document.getElementById('writeups-container');
            if(!container) return;
            const stripHtml = (html) => {
               let tmp = document.createElement("DIV");
               tmp.innerHTML = html;
               return tmp.textContent || tmp.innerText || "";
            }
            const fetchPromises = members.map(async member => {
                const handle = member.startsWith('@') ? member : '@' + member;
                const rssUrl = `https://medium.com/feed/${handle}`;
                const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;
                try {
                    const res = await fetch(apiUrl);
                    const data = await res.json();
                    if (data.status === 'ok') {
                        return data.items.map(item => ({
                            ...item, 
                            authorHandle: handle,
                            cleanDesc: stripHtml(item.description).substring(0, 150) + "..."
                        })); 
                    }
                } catch (e) { console.error(`Failed to fetch for ${member}`, e); }
                return [];
            });
            try {
                const results = await Promise.all(fetchPromises);
                allWriteupPosts = [];
                results.forEach(posts => allWriteupPosts.push(...posts));
                allWriteupPosts.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
                renderWriteups(1);
            } catch (error) { container.innerHTML = '<div class="text-cyber-red font-hud">CONNECTION_ERROR_RETRYING...</div>'; }
        }

        function renderWriteups(page) {
            const container = document.getElementById('writeups-container');
            if(!container) return;
            container.innerHTML = '';
            if (allWriteupPosts.length === 0) {
                container.innerHTML = '<div class="text-gray-500 font-hud text-center p-8 border border-red-900/30">NO_LOGS_DETECTED</div>';
                return;
            }
            const start = (page - 1) * WRITEUPS_PER_PAGE;
            const end = start + WRITEUPS_PER_PAGE;
            const paginatedPosts = allWriteupPosts.slice(start, end);
            const totalPages = Math.ceil(allWriteupPosts.length / WRITEUPS_PER_PAGE);
            paginatedPosts.forEach(post => {
                const dateStr = new Date(post.pubDate).toISOString().split('T')[0];
                container.innerHTML += `
                <a href="${post.link}" target="_blank" class="block p-6 border border-red-900/30 hover:border-cyber-red hover:bg-cyber-red/10 transition-all group">
                    <div class="flex flex-col md:flex-row justify-between items-start mb-2">
                        <h3 class="text-lg md:text-xl font-bold group-hover:text-cyber-red">${post.title}</h3>
                        <span class="text-xs font-hud text-gray-500 mt-1 md:mt-0">${dateStr}</span>
                    </div>
                    <p class="text-sm opacity-70 mb-4 font-mono">${post.cleanDesc}</p>
                    <div class="flex justify-between items-center border-t border-red-900/30 pt-2 mt-2">
                        <span class="text-xs font-hud text-cyber-red">READ_FULL_LOG >></span>
                        <span class="text-xs font-hud text-gray-500">AUTHOR: ${post.authorHandle.toUpperCase()}</span>
                    </div>
                </a>`;
            });
            if (totalPages > 1) {
                let paginationHTML = '<div class="flex flex-col items-center mt-8 gap-2"><div class="flex justify-center items-center gap-2 font-hud">';
                if (page > 1) paginationHTML += `<button onclick="changeWriteupPage(${page - 1})" class="px-3 py-1 border border-red-900/30 text-cyber-red">&lt;</button>`;
                for (let i = 1; i <= totalPages; i++) {
                    const activeClass = i === page ? 'bg-cyber-red text-black border-cyber-red' : 'border-red-900/30 text-gray-500';
                    paginationHTML += `<button onclick="changeWriteupPage(${i})" class="w-8 h-8 flex items-center justify-center border ${activeClass}">${i}</button>`;
                }
                if (page < totalPages) paginationHTML += `<button onclick="changeWriteupPage(${page + 1})" class="px-3 py-1 border border-red-900/30 text-cyber-red">&gt;</button>`;
                paginationHTML += '</div></div>';
                container.innerHTML += paginationHTML;
            }
        }
        function changeWriteupPage(page) {
            currentWriteupPage = page;
            renderWriteups(page);
            const container = document.getElementById('writeups');
            if (container) container.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // --- Navigation & Visuals ---
        let isTransitioning = false;
        function showSection(sectionId) {
            if (isTransitioning) return;
            const currentSection = document.querySelector('.content-section:not(.hidden)');
            if (currentSection && currentSection.id === sectionId) {
                if(window.innerWidth < 768) toggleMenu(true);
                return;
            }
            isTransitioning = true;
            const overlay = document.getElementById('transition-overlay');
            const overlayText = document.getElementById('transition-text');
            overlay.classList.remove('hidden');
            let steps = 0;
            const targetText = "ACCESSING_//_" + sectionId.toUpperCase();
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*";
            const maxSteps = targetText.length + 10;
            const interval = setInterval(() => {
                let result = "";
                for(let i=0; i<targetText.length; i++) {
                    if (i < steps - 5 && Math.random() > 0.1) result += targetText[i];
                    else result += chars[Math.floor(Math.random() * chars.length)];
                }
                overlayText.innerText = result;
                steps++;
                if (steps > maxSteps) {
                    clearInterval(interval);
                    document.querySelectorAll('.content-section').forEach(el => el.classList.add('hidden'));
                    document.getElementById(sectionId).classList.remove('hidden');
                    document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
                    const btn = document.getElementById('btn-' + sectionId);
                    if(btn) btn.classList.add('active');
                    setTimeout(() => {
                        overlay.classList.add('hidden');
                        isTransitioning = false;
                    }, 200);
                }
            }, 40);
        }
        function navTo(sectionId) { showSection(sectionId); if(window.innerWidth < 768) toggleMenu(true); }
        function toggleMenu(forceClose = false) {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('mobile-overlay');
            const isOpen = !sidebar.classList.contains('-translate-x-full');
            if (isOpen || forceClose) {
                sidebar.classList.add('-translate-x-full');
                overlay.classList.add('hidden');
                overlay.classList.remove('opacity-100');
                overlay.classList.add('opacity-0');
            } else {
                sidebar.classList.remove('-translate-x-full');
                overlay.classList.remove('hidden');
                setTimeout(() => {
                    overlay.classList.remove('opacity-0');
                    overlay.classList.add('opacity-100');
                }, 10);
            }
        }
        const textToType = "We are digital explorers and security enthusiasts. A collective of hobbyists, students, and researchers dedicated to understanding how systems work. We break things to learn how to fix them.";
        const typeWriterElement = document.getElementById('typewriter-text');
        let typeIndex = 0;
        function typeWriter() {
            if (typeIndex < textToType.length) {
                typeWriterElement.textContent += textToType.charAt(typeIndex);
                typeIndex++;
                setTimeout(typeWriter, 30);
            }
        }
        function updateClock() {
            const now = new Date();
            const timeString = now.toISOString().split('T')[1].split('.')[0];
            document.getElementById('clock').innerText = timeString;
            const mobileClock = document.getElementById('mobile-clock');
            if(mobileClock) mobileClock.innerText = timeString;
        }
        setInterval(updateClock, 1000);
        updateClock();
        const canvas = document.getElementById('bg-canvas');
        const ctx = canvas.getContext('2d');
        let width, height, particles = [];
        function resize() { width = canvas.width = window.innerWidth; height = canvas.height = window.innerHeight; initParticles(); }
        window.addEventListener('resize', resize);
        class Particle {
            constructor() {
                this.x = Math.random() * width;
                this.y = Math.random() * height;
                this.vx = (Math.random() - 0.5) * 0.5;
                this.vy = (Math.random() - 0.5) * 0.5;
                this.size = Math.random() * 2;
            }
            update() {
                this.x += this.vx; this.y += this.vy;
                if (this.x < 0 || this.x > width) this.vx *= -1;
                if (this.y < 0 || this.y > height) this.vy *= -1;
            }
            draw() {
                ctx.fillStyle = 'rgba(255, 0, 0, 0.3)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        function initParticles() { particles = []; const count = window.innerWidth < 768 ? 20 : 50; for (let i = 0; i < count; i++) { particles.push(new Particle()); } }
        function animate() {
            ctx.clearRect(0, 0, width, height);
            ctx.strokeStyle = 'rgba(255, 0, 0, 0.1)';
            ctx.lineWidth = 1;
            const connectionDist = window.innerWidth < 768 ? 100 : 150;
            for (let i = 0; i < particles.length; i++) {
                particles[i].update();
                particles[i].draw();
                for (let j = i; j < particles.length; j++) {
                    const dx = particles[i].x - particles[j].x;
                    const dy = particles[i].y - particles[j].y;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    if (distance < connectionDist) {
                        ctx.beginPath(); ctx.moveTo(particles[i].x, particles[i].y); ctx.lineTo(particles[j].x, particles[j].y); ctx.stroke();
                    }
                }
            }
            requestAnimationFrame(animate);
        }

        window.onload = function() {
            resize(); animate(); typeWriter();
            showSection('manifesto');
            initWriteups(); 
            initRoster();
            // Sidebar = CTFTime
            initCTFTimeStats();
            // Trophy Room = Supabase
            initTrophyRoom(); 
        }
    </script>
</body>
  <!--maybe there's a clue for you to find out who we are?--!>
</html>
